<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>map test</title>
</head>
<link rel="stylesheet" href="CesiumUnminified/Widgets/widgets.css">
<link rel="stylesheet" href="style.css">

<body>
    <div class="topnav">
        Header
    </div>
    <div class="sidenav">
        <a href="#">N</a>
        <a href="#">A</a>
        <a href="#">V</a>
        <a href="#">I</a>
        <a href="#">G</a>
        <a href="#">A</a>
        <a href="#">T</a>
        <a href="#">I</a>
        <a href="#">O</a>
        <a href="#">N</a>
    </div>
    <div id="map"></div>

    <script src="mago3d/mago3d.js"></script>
    <script src="CesiumUnminified/Cesium.js"></script>
    <script>
        var geopolicy = {};
        geopolicy.basicGlobe = 'cesium';
        geopolicy.terrainType = 'cesium-ion-default';
        geopolicy.initCameraEnable = true;
        geopolicy.initLatitude = 35.139482;
        geopolicy.initLongitude = 128.917656;
        geopolicy.initAltitude = 500;
        geopolicy.initDuration = 0.5;

        var map = new Mago3D.Mago3d('map', geopolicy);

        var f4dController = map.getF4dController();

        var f4dGroup = {
            "metainfo": {
                "isPhysical": false
            },
            "dataGroupId": 1,
            "dataGroupKey": "guide",
            "dataGroupName": "가이드 데이터 그룹",
            "dataGroupPath": "guide",
            "datas": []
        };

        var elementObject = {
            "metainfo": {
                "isPhysical": true,
                "flipYTexCoords": true,
                "heightReference": "clampToGround",
                "isVisible": true
            },
            "dataId": 1,
            "dataGroupId": 1,
            "dataKey": 'default',
            "dataName": 'default',
            "mappingType": "boundingboxcenter",
            "longitude": 128.917656,
            "latitude": 35.139482,
            "height": 14.177629,
            "heading": 0.000000,
            "pitch": 0.000000,
            "roll": 0.000000
        };

        function loadJSON(callback, pathToJson) {
            var xobj = new XMLHttpRequest();
            xobj.overrideMimeType("application/json");
            xobj.open('GET', pathToJson, true);
            xobj.onreadystatechange = function () {
                if (xobj.readyState == 4 && xobj.status == "200") {
                    // Required use of an anonymous callback as .open will NOT return a value but simply returns undefined in asynchronous mode
                    callback(xobj.responseText);
                }
            };
            xobj.send(null);
        }

        var path = 'f4d/guide/mergedLonsLats.json';

        loadJSON(function (response) {
            // Parse JSON string into object
            var actual_JSON = JSON.parse(response);
            for (let i = 0; i < actual_JSON.length; i++) {
                let newElementObject = JSON.parse(JSON.stringify(elementObject));
                newElementObject.dataKey = actual_JSON[i].data_key;
                newElementObject.dataKey = actual_JSON[i].data_key;
                newElementObject.longitude = actual_JSON[i].longitude;
                newElementObject.latitude = actual_JSON[i].latitude;
                f4dGroup.datas.push(newElementObject);
                f4dController.addF4dGroup(f4dGroup);
            }
        }, path);
    </script>
</body>

</html>